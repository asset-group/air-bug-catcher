from fuzzlog.fuzzlog import BoardType, Crash, FuzzedPkt, FuzzLog, ProtocolType


class Exploiter:
    def __init__(
        self, *, session_id: str, protocol: ProtocolType, board: BoardType, fuzzlog: FuzzLog
    ) -> None:
        self.session_id = session_id
        self.protocol = protocol
        self.board = board
        self.fuzzlog = fuzzlog

    def gen_script(self, trial_pkts: list[FuzzedPkt]) -> tuple[str, str]:
        # Return (exploit_name, exploit_path)
        raise NotImplementedError

    def flood_script_generator(self, crash: Crash):
        raise NotImplementedError

    # def run_exploit(self, exploit_name: str, exploit_path: str) -> tuple[bool, list[str]]:
    #     raise NotImplementedError

    def run_exploit_once(
        self, exploit_name: str, exploit_path: str, target_crash_type: str
    ) -> tuple[bool, str]:
        raise NotImplementedError
